<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com https://cdn.tailwindcss.com 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; media-src *; img-src 'self' data: content:;">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    
    <title>Ball Sort Puzzle Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/styles.css">
    
    <!-- Cordova Script - Will load in mobile app environment -->
    <script>
        // Cordova script will be loaded automatically in mobile app
        // For web testing, we simulate the environment
        if (typeof cordova === 'undefined' && /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            // Mobile web environment - load cordova simulation if needed
        }
    </script>
    
    <!-- Ball Expression System -->
    <script src="../js/ball-expressions.js"></script>
    
    <!-- Tube Design System -->
    <script src="../js/tube-designs.js"></script>
    <script src="../js/tube-drawing.js"></script>
    
    <!-- 3D Animated Background System -->
    <script src="../js/animated-background-3d.js"></script>
    
    <!-- User Progress Management -->
    <script src="../js/user-progress.js"></script>
    
    <!-- Google Play Games Services -->
    <script src="../js/google-play-games.js"></script>
    
    <!-- AdMob Manager for Cross-Platform Ad Handling -->
    <script src="../js/admob-manager.js"></script>
</head>
<body class="game-background min-h-screen">
    <!-- 3D Floating Game Elements -->
    <div class="floating-elements">
        <!-- Floating Balls -->
        <div class="floating-ball" style="--ball-color: #ff6b6b; --ball-shadow: #ee5a52; width: 40px; height: 40px; top: 10%; left: 15%; --duration: 8s; --delay: 0s;"></div>
        <div class="floating-ball" style="--ball-color: #4ecdc4; --ball-shadow: #45b7aa; width: 30px; height: 30px; top: 20%; right: 20%; --duration: 10s; --delay: 1s;"></div>
        <div class="floating-ball" style="--ball-color: #45b7d1; --ball-shadow: #3a9bc1; width: 35px; height: 35px; bottom: 25%; left: 10%; --duration: 12s; --delay: 2s;"></div>
        <div class="floating-ball" style="--ball-color: #96ceb4; --ball-shadow: #85b8a3; width: 25px; height: 25px; top: 60%; left: 70%; --duration: 9s; --delay: 3s;"></div>
        <div class="floating-ball" style="--ball-color: #feca57; --ball-shadow: #fd9644; width: 45px; height: 45px; bottom: 15%; right: 15%; --duration: 11s; --delay: 0.5s;"></div>
        <div class="floating-ball" style="--ball-color: #ff9ff3; --ball-shadow: #f368e0; width: 20px; height: 20px; top: 40%; right: 40%; --duration: 7s; --delay: 4s;"></div>
        <div class="floating-ball" style="--ball-color: #54a0ff; --ball-shadow: #2e86de; width: 38px; height: 38px; top: 80%; left: 60%; --duration: 13s; --delay: 1.5s;"></div>
        
        <!-- Floating Tubes -->
        <div class="floating-tube" style="width: 15px; height: 60px; top: 15%; left: 80%; --duration: 15s; --delay: 0s;"></div>
        <div class="floating-tube" style="width: 12px; height: 50px; bottom: 30%; left: 5%; --duration: 18s; --delay: 2s;"></div>
        <div class="floating-tube" style="width: 18px; height: 70px; top: 50%; right: 10%; --duration: 20s; --delay: 4s;"></div>
        <div class="floating-tube" style="width: 10px; height: 40px; bottom: 10%; right: 60%; --duration: 16s; --delay: 1s;"></div>
        
        <!-- Additional Decorative Elements -->
        <div style="position: absolute; top: 25%; left: 45%; width: 60px; height: 60px; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); border-radius: 50%; animation: float3d 14s ease-in-out infinite; animation-delay: 3s;"></div>
        <div style="position: absolute; bottom: 35%; right: 45%; width: 80px; height: 80px; background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%); border-radius: 50%; animation: float3d 16s ease-in-out infinite; animation-delay: 5s;"></div>
    </div>

    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600">
        <div class="text-center p-8 max-w-md mx-4">
            <!-- Animated Logo/Icon -->
            <div class="mb-8 relative">
                <div class="w-32 h-32 mx-auto bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center shadow-2xl animate-bounce">
                    <div class="text-6xl">üéØ</div>
                </div>
                <!-- Floating balls animation -->
                <div class="absolute -top-4 -left-4 w-8 h-8 bg-red-400 rounded-full animate-ping opacity-75"></div>
                <div class="absolute -top-2 -right-6 w-6 h-6 bg-blue-400 rounded-full animate-ping opacity-75 animation-delay-300"></div>
                <div class="absolute -bottom-4 -right-2 w-10 h-10 bg-yellow-400 rounded-full animate-ping opacity-75 animation-delay-600"></div>
                <div class="absolute -bottom-2 -left-6 w-7 h-7 bg-green-400 rounded-full animate-ping opacity-75 animation-delay-900"></div>
            </div>
            
            <!-- Game Title -->
            <h1 class="text-5xl font-bold text-white mb-4 drop-shadow-lg animate-pulse">
                Ball Sort
            </h1>
            <h2 class="text-3xl font-semibold text-white/90 mb-6 drop-shadow-md">
                Puzzle Game
            </h2>
            
            <!-- Description -->
            <p class="text-lg text-white/80 mb-8 leading-relaxed">
                Sort colored balls into tubes!<br>
                Challenge your mind with this addictive puzzle game.
            </p>
            
            <!-- Buttons Container - Ensure Vertical Layout -->
            <div class="flex flex-col items-center space-y-4 w-full">
                <!-- Start Game Button -->
                <button id="startGameBtn" class="group relative overflow-hidden bg-white text-purple-600 px-12 py-4 rounded-2xl text-xl font-bold transition-all duration-300 hover:scale-110 hover:shadow-2xl active:scale-95 w-full max-w-xs">
                    <span class="relative z-10">üéÆ Start Game</span>
                    <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-orange-400 transform translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
                    <span class="absolute inset-0 flex items-center justify-center text-white font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20">
                        Let's Play! üöÄ
                    </span>
                </button>
                
                <!-- Game Info Button -->
                <button id="gameInfoBtn" class="group relative overflow-hidden bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-8 py-3 rounded-xl text-lg font-semibold transition-all duration-300 hover:scale-105 hover:shadow-xl active:scale-95 w-full max-w-xs">
                    <span class="relative z-10">üìä Game Info</span>
                    <div class="absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 transform translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
                    <span class="absolute inset-0 flex items-center justify-center text-white font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20">
                        Levels & Tips! üéØ
                    </span>
                </button>

                <!-- Go Ads Free Button (Hidden by default until premium status is checked) -->
                <button id="goAdsFreeBtn" class="group relative overflow-hidden bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-8 py-3 rounded-xl text-lg font-semibold transition-all duration-300 hover:scale-105 hover:shadow-xl active:scale-95 w-full max-w-xs">
                    <span class="relative z-10">‚ú® Go Ads Free</span>
                    <div class="absolute inset-0 bg-gradient-to-r from-yellow-600 to-orange-600 transform translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
                    <span class="absolute inset-0 flex items-center justify-center text-white font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20">
                        $9.99 Only! üíé
                    </span>
                </button>
            </div>
            
            <!-- Version/Credits -->
            <div class="mt-8 text-white/60 text-sm">
                <p>üé≤ Version 1.0 | Premium Puzzle Experience</p>
            </div>
        </div>
        
        <!-- Background decoration -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-10 left-10 w-20 h-20 bg-white/10 rounded-full animate-float"></div>
            <div class="absolute top-20 right-20 w-16 h-16 bg-white/10 rounded-full animate-float animation-delay-500"></div>
            <div class="absolute bottom-20 left-20 w-24 h-24 bg-white/10 rounded-full animate-float animation-delay-1000"></div>
            <div class="absolute bottom-10 right-10 w-18 h-18 bg-white/10 rounded-full animate-float animation-delay-1500"></div>
        </div>
    </div>

    <!-- Game Container -->
    <div id="gameContainer" class="container mx-auto px-4 py-6">
        <!-- Top Bar -->
        <div id="topBar" class="flex justify-between items-center mb-6 bg-white/20 backdrop-blur-sm rounded-xl p-4 shadow-lg">
            <!-- 1st Horizontal Layout: Game Title and Info (Left Side) -->
            <div class="flex flex-col items-center space-y-2 flex-1">
                <h1 class="text-xl font-bold text-white">Ball Sort Puzzle</h1>
                <div class="flex items-center space-x-2 text-white">
                    <span class="bg-white/20 px-2 py-1 rounded-lg text-xs">Level: <span id="levelDisplay">1/1000</span></span>
                    <span class="bg-gradient-to-r from-green-500 to-blue-500 px-2 py-1 rounded-lg text-xs font-semibold" id="difficultyDisplay">Very Easy</span>
                    <span id="timerDisplay" class="bg-white/20 px-2 py-1 rounded-lg text-xs">Time: <span id="timeLeft">1:00</span></span>
                </div>
            </div>
            
            <!-- 2nd Horizontal Layout: More Options Button (Right Side) -->
            <div class="flex items-center justify-center">
                <button id="moreOptionsBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                    ‚öôÔ∏è More Options
                </button>
            </div>
        </div>
        
        <!-- Options Popup Modal -->
        <div id="optionsModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden items-center justify-center">
            <div class="bg-gradient-to-br from-purple-800 to-blue-900 p-6 rounded-xl shadow-2xl border border-white/20 max-w-sm w-full mx-4 transform transition-all duration-300">
                <!-- Modal Header -->
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-white text-lg font-bold">‚öôÔ∏è Game Options</h2>
                    <button id="closeModalBtn" class="text-white/70 hover:text-white text-xl">‚úï</button>
                </div>
                
                <!-- Google Sign In/Out -->
                <div class="flex items-center justify-center space-x-3 mb-4">
                    <button id="googleSignInBtn" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                        üîë Sign In
                    </button>
                    <button id="googleSignOutBtn" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg transition-colors text-sm hidden">
                        üö™ Sign Out
                    </button>
                </div>
                
                <!-- Sound Toggle and Leaderboard -->
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <button id="soundToggle" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üîä
                    </button>
                    <button id="leaderboardBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors">
                        üèÜ
                    </button>
                </div>
                
                <!-- User Info -->
                <div class="text-center mb-4">
                    <div id="userInfo" class="text-white text-sm">
                        <span id="userName" class="bg-white/20 px-2 py-1 rounded hidden block mb-2">üë§ Player</span>
                        <span id="authStatus" class="bg-blue-500/50 px-2 py-1 rounded text-xs">Not Signed In</span>
                    </div>
                </div>
                
                <!-- Moves Counter -->
                <div class="text-center">
                    <div class="text-white">
                        <span class="bg-white/20 px-3 py-2 rounded-lg">Moves: <span id="moveCounter">0</span></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Canvas -->
        <div class="flex justify-center mb-6">
            <div class="game-canvas-container">
                <canvas id="gameCanvas" class="bg-white/10 backdrop-blur-sm rounded-xl shadow-2xl border-2 border-white/20"></canvas>
                
                <!-- 3D Animated Background -->
                <div class="game-canvas-3d-background">
                    <!-- Floating 3D Balls -->
                    <div class="floating-3d-ball" style="--ball-color: #ff6b6b; --ball-shadow: #ee5a52; --ball-glow: 255, 107, 107; width: 25px; height: 25px; top: 10%; left: 5%; --duration: 8s; --delay: 0s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #4ecdc4; --ball-shadow: #45b7aa; --ball-glow: 78, 205, 196; width: 18px; height: 18px; top: 25%; right: 8%; --duration: 12s; --delay: 2s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #45b7d1; --ball-shadow: #3a9bc1; --ball-glow: 69, 183, 209; width: 22px; height: 22px; bottom: 30%; left: 10%; --duration: 10s; --delay: 1s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #96ceb4; --ball-shadow: #85b8a3; --ball-glow: 150, 206, 180; width: 16px; height: 16px; top: 60%; left: 85%; --duration: 14s; --delay: 3s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #feca57; --ball-shadow: #fd9644; --ball-glow: 254, 202, 87; width: 28px; height: 28px; bottom: 15%; right: 12%; --duration: 9s; --delay: 1.5s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #ff9ff3; --ball-shadow: #f368e0; --ball-glow: 255, 159, 243; width: 20px; height: 20px; top: 45%; right: 60%; --duration: 11s; --delay: 4s;"></div>
                    <div class="floating-3d-ball" style="--ball-color: #54a0ff; --ball-shadow: #2e86de; --ball-glow: 84, 160, 255; width: 24px; height: 24px; top: 75%; left: 50%; --duration: 13s; --delay: 2.5s;"></div>
                    
                    <!-- Floating 3D Tubes -->
                    <div class="floating-3d-tube" style="--tube-color: 102, 126, 234; --tube-glow: 102, 126, 234; width: 12px; height: 45px; top: 20%; left: 25%; --duration: 15s; --delay: 0s;"></div>
                    <div class="floating-3d-tube" style="--tube-color: 245, 87, 108; --tube-glow: 245, 87, 108; width: 10px; height: 38px; bottom: 40%; left: 75%; --duration: 18s; --delay: 3s;"></div>
                    <div class="floating-3d-tube" style="--tube-color: 79, 172, 254; --tube-glow: 79, 172, 254; width: 14px; height: 52px; top: 50%; right: 30%; --duration: 16s; --delay: 1s;"></div>
                    <div class="floating-3d-tube" style="--tube-color: 150, 206, 180; --tube-glow: 150, 206, 180; width: 8px; height: 35px; bottom: 25%; right: 70%; --duration: 20s; --delay: 4s;"></div>
                    
                    <!-- 3D Geometric Shapes -->
                    <div class="floating-3d-geometry geometry-cube" style="--geo-color: 255, 107, 107; --size: 15px; top: 30%; left: 15%; --duration: 20s; --delay: 0s;"></div>
                    <div class="floating-3d-geometry geometry-triangle" style="--geo-color: 78, 205, 196; --size: 18px; top: 70%; left: 80%; --duration: 22s; --delay: 5s;"></div>
                    <div class="floating-3d-geometry geometry-cube" style="--geo-color: 84, 160, 255; --size: 12px; bottom: 60%; right: 25%; --duration: 18s; --delay: 2s;"></div>
                    <div class="floating-3d-geometry geometry-triangle" style="--geo-color: 254, 202, 87; --size: 16px; top: 15%; right: 15%; --duration: 24s; --delay: 6s;"></div>
                    
                    <!-- Particle System -->
                    <div class="particle-system">
                        <div class="particle" style="--particle-color: 255, 107, 107; --size: 3px; left: 10%; --duration: 12s; --delay: 0s; --drift: 30px;"></div>
                        <div class="particle" style="--particle-color: 78, 205, 196; --size: 4px; left: 25%; --duration: 15s; --delay: 2s; --drift: -20px;"></div>
                        <div class="particle" style="--particle-color: 69, 183, 209; --size: 2px; left: 45%; --duration: 10s; --delay: 1s; --drift: 40px;"></div>
                        <div class="particle" style="--particle-color: 150, 206, 180; --size: 5px; left: 65%; --duration: 18s; --delay: 3s; --drift: -15px;"></div>
                        <div class="particle" style="--particle-color: 254, 202, 87; --size: 3px; left: 80%; --duration: 14s; --delay: 4s; --drift: 25px;"></div>
                        <div class="particle" style="--particle-color: 255, 159, 243; --size: 4px; left: 35%; --duration: 16s; --delay: 1.5s; --drift: -30px;"></div>
                        <div class="particle" style="--particle-color: 84, 160, 255; --size: 2px; left: 55%; --duration: 11s; --delay: 2.5s; --drift: 35px;"></div>
                        <div class="particle" style="--particle-color: 245, 87, 108; --size: 3px; left: 75%; --duration: 13s; --delay: 5s; --drift: -25px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Banner Ad Container -->
        <div id="bannerAdContainer" class="flex justify-center mb-4">
            <div id="bannerAd" class="bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 overflow-hidden">
                <!-- AdMob banner will be inserted here -->
                <div id="bannerAdPlaceholder" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white text-center py-3 px-6 text-sm">
                    üéÆ Support the game - Ad loading...
                </div>
            </div>
        </div>

        <!-- Bottom Controls -->
        <div id="bottomBar" class="flex justify-center space-x-4 mb-6">
            <button id="undoBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                Undo
            </button>
            <button id="hintBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                Hint
            </button>
            <button id="shuffleBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                Shuffle
            </button>
        </div>

        <!-- Game Info Panel -->
        <div id="infoPanel" class="bg-white/20 backdrop-blur-sm rounded-xl p-4 shadow-lg text-white text-center">
            <p id="gameMessage">Click on a tube to select a ball, then click another tube to move it!</p>
            <div class="mt-2 flex gap-2 justify-center">
                <button id="testSoundBtn" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                    Test Sound üîä
                </button>
                <button id="resetProgressBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                    Reset to Level 1 üîÑ
                </button>
            </div>
        </div>
    </div>

    <!-- Interstitial Ad Modal (Level Completion) -->
    <div id="interstitialAdModal" class="fixed inset-0 bg-black flex items-center justify-center z-60 hidden">
        <div class="w-full h-full bg-gradient-to-br from-purple-600 via-blue-600 to-teal-500 flex flex-col items-center justify-center text-white relative">
            <!-- Ad Content -->
            <div class="text-center mb-8">
                <div class="text-8xl mb-4">üéÆ</div>
                <h1 class="text-4xl font-bold mb-2">Congratulations!</h1>
                <p class="text-xl mb-4">Level completed successfully!</p>
                <div class="bg-black/30 rounded-lg p-6 max-w-md">
                    <h2 class="text-2xl font-semibold mb-2">üéØ Try More Puzzle Games!</h2>
                    <p class="text-lg">Challenge your mind with exciting puzzles</p>
                </div>
            </div>
            
            <!-- Timer and Close Button -->
            <div class="absolute top-4 right-4 text-right">
                <div class="bg-black/50 rounded-lg p-3 mb-2">
                    <p class="text-sm">Ad ends in: <span id="interstitialTimer" class="font-bold">5</span>s</p>
                </div>
                <button id="closeInterstitialAd" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-all duration-300 opacity-0 pointer-events-none" disabled>
                    ‚úï Close
                </button>
            </div>
            
            <!-- Progress Bar -->
            <div class="absolute bottom-0 left-0 w-full bg-black/30 h-2">
                <div id="interstitialProgress" class="bg-white h-full transition-all duration-1000 ease-linear" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- Victory Modal -->
    <div id="victoryModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-8 text-center shadow-2xl max-w-md mx-4">
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Level <span id="completedLevel">1</span> Complete!</h2>
            
            <!-- Difficulty Achievement -->
            <div class="mb-4">
                <span class="inline-block bg-gradient-to-r from-green-400 to-green-600 text-white px-4 py-2 rounded-full text-sm font-semibold" id="completedDifficulty">Very Easy</span>
            </div>
            
            <!-- Progress Info -->
            <div class="bg-gray-100 rounded-lg p-4 mb-4">
                <p class="text-gray-600 mb-2">Moves: <span id="finalMoves" class="font-semibold text-gray-800">0</span></p>
                <p class="text-gray-600 mb-2">Time: <span id="finalTime" class="font-semibold text-gray-800">0:00</span></p>
                <div class="mt-3">
                    <div class="text-xs text-gray-500 mb-1" id="progressText">Progress: 1/200 levels</div>
                    <div class="w-full bg-gray-300 rounded-full h-2">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-500" id="progressBar" style="width: 0.5%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Special Messages -->
            <div id="specialMessage" class="text-sm text-purple-600 font-medium mb-4 hidden"></div>
            
            <div class="flex gap-2 justify-center">
                <button id="nextLevelBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors">
                    Next Level
                </button>
                <button id="replayBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors">
                    Replay
                </button>
            </div>
        </div>
    </div>

    <!-- Time Up Modal -->
    <div id="timeUpModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-8 text-center shadow-2xl max-w-md mx-4">
            <div class="text-6xl mb-4">‚è∞</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Time's Up!</h2>
            <p class="text-gray-600 mb-2">You ran out of time for this level.</p>
            <p class="text-gray-600 mb-6">Watch an ad to get 30 seconds or try again!</p>
            <div class="space-y-3">
                <button id="watchAdBtn" class="w-full bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors font-bold">
                    üì∫ Watch Ad (30s)
                </button>
                <button id="retryLevelBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors">
                    üîÑ Restart Level
                </button>
            </div>
        </div>
    </div>

    <!-- Pause Modal -->
    <div id="pauseModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-8 text-center shadow-2xl max-w-md mx-4">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Game Paused</h2>
            <button id="resumeBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors mr-2">
                Resume
            </button>
            <button id="mainMenuBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition-colors">
                Main Menu
            </button>
        </div>
    </div>

    <!-- Game Info Modal -->
    <div id="gameInfoModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 text-center shadow-2xl max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">üéÆ Ball Sort Game Info</h2>
            
            <!-- Game Overview -->
            <div class="mb-6 p-4 bg-purple-50 rounded-lg">
                <h3 class="text-xl font-semibold text-purple-800 mb-2">üìä Game Overview</h3>
                <p class="text-gray-700">
                    Welcome to Ball Sort Puzzle! Sort colored balls into test tubes by color. 
                    Challenge yourself through <strong>1000 levels</strong> of increasing difficulty!
                </p>
            </div>

            <!-- Difficulty Tiers Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                <!-- Very Easy -->
                <div class="bg-green-50 border-2 border-green-200 rounded-lg p-4">
                    <div class="text-green-600 text-2xl mb-2">üü¢</div>
                    <h4 class="font-bold text-green-800">Very Easy</h4>
                    <p class="text-sm text-green-600 mb-2">Levels 1-25</p>
                    <p class="text-xs text-gray-600">‚è±Ô∏è Time: 60-75 seconds</p>
                    <p class="text-xs text-gray-600">üé® Colors: 3-4</p>
                </div>

                <!-- Easy -->
                <div class="bg-lime-50 border-2 border-lime-200 rounded-lg p-4">
                    <div class="text-lime-600 text-2xl mb-2">üü°</div>
                    <h4 class="font-bold text-lime-800">Easy</h4>
                    <p class="text-sm text-lime-600 mb-2">Levels 26-50</p>
                    <p class="text-xs text-gray-600">‚è±Ô∏è Time: 75-90 seconds</p>
                    <p class="text-xs text-gray-600">üé® Colors: 4-5</p>
                </div>

                <!-- Medium -->
                <div class="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4">
                    <div class="text-yellow-600 text-2xl mb-2">üü†</div>
                    <h4 class="font-bold text-yellow-800">Medium</h4>
                    <p class="text-sm text-yellow-600 mb-2">Levels 51-100</p>
                    <p class="text-xs text-gray-600">‚è±Ô∏è Time: 90-120 seconds</p>
                    <p class="text-xs text-gray-600">üé® Colors: 5-6</p>
                </div>

                <!-- Hard -->
                <div class="bg-orange-50 border-2 border-orange-200 rounded-lg p-4">
                    <div class="text-orange-600 text-2xl mb-2">üî¥</div>
                    <h4 class="font-bold text-orange-800">Hard</h4>
                    <p class="text-sm text-orange-600 mb-2">Levels 101-200</p>
                    <p class="text-xs text-gray-600">‚è±Ô∏è Time: 120-180 seconds</p>
                    <p class="text-xs text-gray-600">üé® Colors: 6-7</p>
                </div>

                <!-- Hard to Very Hard -->
                <div class="bg-red-50 border-2 border-red-200 rounded-lg p-4">
                    <div class="text-red-600 text-2xl mb-2">üî•</div>
                    <h4 class="font-bold text-red-800">Hard to Very Hard</h4>
                    <p class="text-sm text-red-600 mb-2">Levels 201-1000</p>
                    <p class="text-xs text-gray-600">‚è±Ô∏è Time: 180 seconds</p>
                    <p class="text-xs text-gray-600">üé® Colors: 7-12</p>
                </div>

                <!-- Bonus Info -->
                <div class="bg-purple-50 border-2 border-purple-200 rounded-lg p-4">
                    <div class="text-purple-600 text-2xl mb-2">‚≠ê</div>
                    <h4 class="font-bold text-purple-800">Pro Tips</h4>
                    <p class="text-sm text-purple-600 mb-2">Strategy Matters!</p>
                    <p class="text-xs text-gray-600">üß† Plan ahead</p>
                    <p class="text-xs text-gray-600">üéØ Use empty tubes wisely</p>
                </div>
            </div>

            <!-- Level Milestones -->
            <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                <h3 class="text-xl font-semibold text-blue-800 mb-3">üèÜ Milestones & Rewards</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                    <div class="bg-white p-2 rounded border">
                        <div class="font-bold text-blue-600">Level 50</div>
                        <div class="text-xs text-gray-600">First Challenge!</div>
                    </div>
                    <div class="bg-white p-2 rounded border">
                        <div class="font-bold text-purple-600">Level 100</div>
                        <div class="text-xs text-gray-600">Century Club!</div>
                    </div>
                    <div class="bg-white p-2 rounded border">
                        <div class="font-bold text-orange-600">Level 200</div>
                        <div class="text-xs text-gray-600">Master Sorter!</div>
                    </div>
                    <div class="bg-white p-2 rounded border">
                        <div class="font-bold text-red-600">Level 1000</div>
                        <div class="text-xs text-gray-600">Ultimate Champion!</div>
                    </div>
                </div>
            </div>

            <!-- Game Features -->
            <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">üéÆ Game Features</h4>
                    <ul class="text-sm text-gray-600 text-left space-y-1">
                        <li>‚Ä¢ Progressive difficulty scaling</li>
                        <li>‚Ä¢ Strategic time management</li>
                        <li>‚Ä¢ Undo moves for better planning</li>
                        <li>‚Ä¢ Achievement milestones</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">‚ö° Power-ups & Ads</h4>
                    <ul class="text-sm text-gray-600 text-left space-y-1">
                        <li>‚Ä¢ Watch ads for extra time</li>
                        <li>‚Ä¢ Premium ad-free experience</li>
                        <li>‚Ä¢ Google Play Games integration</li>
                        <li>‚Ä¢ Leaderboard competition</li>
                    </ul>
                </div>
            </div>

            <button id="closeGameInfoBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-8 py-3 rounded-lg transition-colors font-bold">
                ‚ú® Got it! Let's Play!
            </button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="popSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QPwkUX7br66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2Q=" type="audio/wav">
    </audio>
    
    <audio id="victorySound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QPwkUX7br66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFAlFnt/yv2IcBTyX1/LBeSsFJ3nJ8N2QQAoUXrTp66hVFApGn+DyvmEcBT2Y1/LBeSsFJ3nJ8N2Q=" type="audio/wav">
    </audio>

    <script src="../js/game.js"></script>
</body>
</html>
